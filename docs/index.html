---

title: Jacobs VAULT

keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>VAULT contains scripts and notebooks that (a) ingest and characterize the provided AIS shipping tracks and satellite TLE data, (b) find "hits" - satellites are visible for a given ship position, and (c) highlight coverage gaps / flaws in the data.  Here is an example starmap showing satellites visible from one point on track, colored by quality of the satellite's TLE data.</p>
<p><table>
    <tr style="background-color:#EEEEEE">
        <td ><img src="images/Jacobs_logo_rgb_black.svg" width="200"/></td>
        <td><img alt="Satellites Visible" src="images/polar_plot2.png" width="300"></td>
    </tr>
</table>
(For demo purposes, we treat all entries in the TLE file as viable satellites, when in reality most are space junk.)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installing">Installing<a class="anchor-link" href="#Installing"> </a></h2><p>These instructions require Docker <a href="https://docs.docker.com/get-docker/">(obtained here)</a> and a DockerHub account <a href="https://hub.docker.com/">(obtained here)</a>.</p>
<p>Once docker is installed and the DockerHub account is established, in your operating system command line run:</p>
<div class="highlight"><pre><span></span>docker login
docker pull ke2jacobs/jacobs-vault-nb-with-data:latest
docker run --rm -it -p <span class="m">2080</span>:2080 ke2jacobs/jacobs-vault-nb-with-data:latest
</pre></div>
<p>The container will present a message:</p>

<pre><code>To access the notebook, open this file in a browser:         
file:///root/.local/share/jupyter/runtime/nbserver-1-open.html    
Or copy and paste one of these URLs:       
http://d20796a21c64:2080/?token=455d272e289a90dbc2533de2cb7ddec9a5574dc3fac5ef66
     or     
http://127.0.0.1:2080/?token=455d272e289a90dbc2533de2cb7ddec9a5574dc3fac5ef66</code></pre>
<p>Open a browser window and paste the URL into the browser (<a href="http://127.0.0.1">http://127.0.0.1</a>: â€¦ is usually the best choice)</p>
<p>The main Jupyter page will be displayed.</p>
<ul>
<li>Click on the folder named "demo"</li>
<li>Click on the file named "VAULT_Demo.ipynb"</li>
<li>Click on the "Cell" menu item and choose "Run All"</li>
</ul>
<h2 id="Exploring-More">Exploring More<a class="anchor-link" href="#Exploring-More"> </a></h2><p>If you are familiar with <code>git</code>, then you can <code>git clone</code> this repository into say <code>jacobs-vault</code>.</p>
<ul>
<li>Change to that folder</li>
<li>VAULT data has to be obtained separately. ETL'ed data must be available via <code>data/</code>.</li>
</ul>
<h3 id="Demo">Demo<a class="anchor-link" href="#Demo"> </a></h3><p>Once data are in place, the demo can be run like this:</p>
<div class="highlight"><pre><span></span><span class="nb">cd</span> demo
ln -s ../data ./
. run.sh
</pre></div>
<p>The <code>ln</code> line just makes ETL'd data visible from <code>demo/data</code>. Use other techniques if you prefer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="About-jacobs-vault">About jacobs-vault<a class="anchor-link" href="#About-jacobs-vault"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Jacobs-VAULT is the result of a hackathon challenge, so in addition to a working demo and analysis notebooks, it still has exploratory paths and alternate approaches. Folders are in three rough groups:</p>
<h3 id="ETL-Folders">ETL Folders<a class="anchor-link" href="#ETL-Folders"> </a></h3><ul>
<li><code>etl</code> - Original ETL scripts, mostly Spark SQL and Hive.</li>
<li><code>ais-analytics</code> - Subproject Spark to analyze AIS data. Alternate ETL.</li>
<li><code>geotransformer</code> - Subproject using Spark to analyze TLE data. Alternate ETL. Directly calls <code>sgp4</code> and the <code>astropy</code> package, instead of <code>skyfield</code>.</li>
</ul>
<h3 id="nbdev-Folders">nbdev Folders<a class="anchor-link" href="#nbdev-Folders"> </a></h3><p>A mix of exploratory notebooks and literate programming notebooks that generate Python modules and documentation (including this README) via the <code>nbdev</code> package. Controlled by the toplevel <code>Makefile</code>, using the <code>vault</code> virtual environment captured in <code>environment.yml</code>.</p>
<ul>
<li><code>nbs</code> - Toplevel notebooks, generate docs, modules, and README.</li>
<li><code>jacobs_vault</code> - Python modules generated from <code>nbs/</code> by <code>nbdev</code> package</li>
<li><code>docs</code> - Documentation generated from <code>nbs/</code> by <code>nbdev</code> package</li>
<li><code>data</code> - (See "Demo Folders".)</li>
</ul>
<p>To run the notebooks in the <code>nbs/</code> folder, 
activate the <code>vault</code> Python virtual environment and start a new jupyter kernel.</p>
<div class="highlight"><pre><span></span>conda env -f environment.yml
conda activate vault
jupyter notebook
</pre></div>
<p>That should start a jupyter session in your browser. You can now explore and run the notebooks in the <code>nbs/</code> folder.</p>
<h3 id="Demo-Folders">Demo Folders<a class="anchor-link" href="#Demo-Folders"> </a></h3><p>The demo supports a notebook with an interactive map-based walktrhough of getting AIS tracks, and querying a track for satellite coverage, using the <code>Skyfield</code> package for ephemeris calculations.</p>
<ul>
<li><code>demo</code> - As much of the demo as possible lives under here, for completeness.</li>
<li><code>data</code> - Daily satellite files stored (or linked) as<code>data/VAULT_Data/TLE_daily/</code><em>year</em><code>/</code><em>MM</em><code>/</code><em>nn</em><code>.tab.gz</code>. Used by the demo <em>and</em> other notebooks &amp; scripts.  </li>
</ul>
<h3 id="Other-folders">Other folders<a class="anchor-link" href="#Other-folders"> </a></h3><ul>
<li><code>autoencoder</code> - Exploratory work using a PyTorch deep network to discover high-level features and pattersn in the AIS data.</li>
<li><code>ais-kml</code> - Concurrent visualization attempt using OpenSphere.</li>
<li><code>hitttestservice</code> - First attempt to wrap HitTest code into a web service.</li>
<li><code>scripts</code> - A collection of scripts, esp. SQL queries.</li>
</ul>
<h3 id="A-note-on-Spark">A note on Spark<a class="anchor-link" href="#A-note-on-Spark"> </a></h3><p>Some code expects an Apache Spark setup with Hive and Hadoop available. The <code>ais-analytics</code> and <code>geotransformer</code> folders contain <code>cookie-cutter</code> setups with scripts that 
will start Spark-enabled jupyter notebooks, or launch a spark job with the required virtual environment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Key-Required-Packages">Key Required Packages<a class="anchor-link" href="#Key-Required-Packages"> </a></h2><p>After cloning the repository, use the <code>conda</code> package manager to install the main dependencies. (We provide files for <code>pip</code>, but we recommend conda.)</p>
<div class="highlight"><pre><span></span>conda env create -f environment.yml
</pre></div>
<p>Key top-level packages fall in three broad categories:</p>
<h3 id="Scientific-Python-Ecosystem:">Scientific Python Ecosystem:<a class="anchor-link" href="#Scientific-Python-Ecosystem:"> </a></h3><ul>
<li>Core: <a href="https://numpy.org">numpy</a>, <a href="https://pandas.pydata.org">pandas</a></li>
<li>Astronomy: <a href="https://rhodesmill.org/skyfield/">Skyfield</a>, <a href="https://www.astropy.org">astropy</a>, <a href="https://gdal.org">GDAL</a>, (pyorbital??)</li>
<li>Clustering: <a href="https://hdbscan.readthedocs.io/en/latest/index.html">HDBSCAN</a></li>
<li>Notebooks:  <a href="https://ipython.org">ipython</a>, <a href="https://jupyter.org">jupyter</a> notebooks.</li>
</ul>
<h3 id="Cloud-Computing">Cloud Computing<a class="anchor-link" href="#Cloud-Computing"> </a></h3><ul>
<li><a href="https://spark.apache.org">Spark</a> including PySpark, <a href="https://hive.apache.org">Hive</a>, <a href="https://hadoop.apache.org">Hadoop</a></li>
<li>(Other database as req'd)</li>
<li>Map support: geopandas, ...</li>
<li>Visualization: plotly, (matplotlib?), (leaflet?), (opensphere?)</li>
</ul>
<h3 id="Literate-Programming:">Literate Programming:<a class="anchor-link" href="#Literate-Programming:"> </a></h3><ul>
<li><a href="https://nbdev.fast.ai">nbdev</a>, <a href="https://cookiecutter.readthedocs.io/en/latest/README.html">cookie-cutter</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Tests are automatically extracted from notebooks in <code>nbs/</code>. To run the tests in parallel, launch:</p>
<p><code>nbdev_test_nbs</code> or <code>make test</code></p>
<p>For all the tests to pass, you'll need to install the following optional dependencies:</p>

<pre><code>pip install ...</code></pre>
<p>Tests are written using <code>nbdev</code>, for example see the documentation for <a href="/jacobs-vault/HitTest#hit_quality"><code>hit_quality</code></a> or <a href="/jacobs-vault/HitTest#viz"><code>viz</code></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Contributing">Contributing<a class="anchor-link" href="#Contributing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can clone the repository and install dependencies with ...</p>

<pre><code>git clone https://github.com/cmorris-jacobs/jacobs-vault
pip install -e "jacobs-vault[dev]"</code></pre>
<p>After you clone this repository, please run <code>nbdev_install_git_hooks</code> in your terminal. This sets up git hooks, which clean up the notebooks to remove the extraneous stuff stored in the notebooks (e.g. which cells you ran) which causes unnecessary merge conflicts.</p>
<p>Before submitting a PR, check that the local library and notebooks match. The script <code>nbdev_diff_nbs</code> can let you know if there is a difference between the local library and the notebooks.</p>
<ul>
<li>If you made a change to the <em>notebooks</em> in one of the exported cells, you can export it to the library with <code>nbdev_build_lib</code> or <code>make jacobs-vault</code>.</li>
<li>If you made a (small) change to the <em>library</em>, you can export it back to the notebooks with <code>nbdev_update_lib</code>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Docker-Containers">Docker Containers<a class="anchor-link" href="#Docker-Containers"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We do not yet have official docker containers, but when done they should be available from <a href="https://github.com/cmorris-jacobs/docker-containers#jacobs-vault">the github site</a>.</p>

</div>
</div>
</div>
</div>
 

